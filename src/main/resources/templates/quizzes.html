<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Quiz</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Icons">
  <link href="css/style.css" rel="stylesheet">
  <!-- Header Fragment -->
  <header th:replace="~{fragments/header :: header}"></header>
  <style>
  </style>
</head>

<body id="Mbody">
  <h1 style="text-align: center; color: #000000; font-size: 3rem; margin-top: 30px;">Math Quiz!</h1>

  <!-- Timer -->
  <div id="quiz-timer">⏰ Time Remaining: 10:00</div>

  <!-- Quiz Container -->
  <div class="quiz-container">
    <!-- Quiz Question -->
    <div class="quiz-question">
      <h3 id="question" th:text="${quizzes[0].question}"></h3>
      <div class="quiz-options col-2 row-cols-2">
        <ul>
          <li th:each="answer : ${#strings.arraySplit(quizzes[0].answers, ',')}" >
            <input type="radio" name="question1" th:value="${answer}" th:id="${answer}">
            <label th:for="${answer}" th:text="${answer}"></label>
          </li>
        </ul>
      </div>
    </div>

    <!-- Quiz Navigation -->
    <div class="quiz-navigation">
      <button id="prev-btn" disabled>⬅️ Previous</button>
      <button id="next-btn">Next ➡️</button>
    </div>
  </div>

  <script>
    // Get quiz data from Thymeleaf
    const quizzes = /*[[${quizzes}]]*/ [];
    let currentQuestionIndex = 0;

    function loadQuiz() {
      const questionElement = document.getElementById("question");
      const answerOptionsElement = document.querySelector(".quiz-options ul");

      // Get current question
      const currentQuiz = quizzes[currentQuestionIndex];

      // Set question
      questionElement.textContent = currentQuiz.question;

      // Clear previous answers
      answerOptionsElement.innerHTML = "";

      // Split answers and create answer choices
      const answers = currentQuiz.answers.split(",");
      answers.forEach(answer => {
        const optionHTML = `
                <li>
                    <input type="radio" name="quiz" value="${answer}" id="${answer}">
                    <label for="${answer}">${answer}</label>
                </li>
            `;
        answerOptionsElement.insertAdjacentHTML("beforeend", optionHTML);
      });

      // Enable or disable buttons
      document.getElementById("prev-btn").disabled = (currentQuestionIndex === 0);
      document.getElementById("next-btn").disabled = (currentQuestionIndex === quizzes.length - 1);
    }

    document.addEventListener("DOMContentLoaded", () => {
      loadQuiz();

      document.getElementById("next-btn").addEventListener("click", () => {
        if (currentQuestionIndex < quizzes.length - 1) {
          currentQuestionIndex++;
          loadQuiz();
        }
      });

      document.getElementById("prev-btn").addEventListener("click", () => {
        if (currentQuestionIndex > 0) {
          currentQuestionIndex--;
          loadQuiz();
        }
      });
    });
  </script>

  <script src="js/timer.js"></script>
</body>
<!-- footer Fragment -->
<footer th:replace="~{fragments/footer :: footer}"></footer>

</html>